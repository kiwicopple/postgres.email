{
  "fixtures": [
    {
      "name": "codeblocks_and_links",
      "id": "<CACJufxHu0sXO8791FDcNXp2bFnE89jyuGkJbLCQkhgWq6XuNLg@mail.gmail.com>",
      "description": "Email with code blocks and links - testing that formatting is preserved",
      "body_text": "hi.\nOn select cast(NULL::text as unknown);\n\nwe got:\nERROR:  failed to find conversion function from unknown to text\n\nfrom src/backend/parser/parse_coerce.c:\nthe code path is:\ncoerce_type:\n\n    case UNKNOWNOID:\n        /*\n         * We permit coercing an unknown constant to any non-array target type,\n         * so long as we can coerce the constant's presumed type to the target.\n         * This is useful for example with VALUES clauses.\n         */\n        if (node && IsA(node, Const) &&\n            !targetTypeId->typelem)\n        {\n            Const      *con = (Const *) node;\n\n            /* If target is a domain, apply constraints */\n            if (targetTypeId->typtype == TYPTYPE_DOMAIN)\n                con = coerce_to_domain((Node *) con, InvalidOid, -1,\n                                      targetTypeId->oid,\n                                      COERCE_IMPLICIT_CAST, -1,\n                                      false, false);\n            return (Node *) con;\n        }\n        break;\n\n  as you can see the code path only coerce type UNKNOWNOID to other types if it is a Const node.\n\nBut if I have a real table, with one column as text type.\nsee also https://www.postgresql.org/message-id/20070406175131.3FABF7FED85%40cvs.postgresql.org\n\nI also found similar discussion at:\nhttps://www.postgresql.org/message-id/87blddjojx.fsf%40news-spur.riddles.org.uk\n\n--\nRegards,\nJian He"
    },
    {
      "name": "simple_text_with_url",
      "description": "Simple email with plain text and a URL",
      "body_text": "Hello everyone,\n\nCheck out this documentation:\nhttps://www.postgresql.org/docs/current/\n\nThanks!"
    },
    {
      "name": "quoted_text",
      "description": "Email with quoted reply text",
      "body_text": "I agree with your assessment.\n\n> On Jan 15, 2026, someone wrote:\n> This is the original message that I'm replying to.\n> It has multiple lines.\n>\n> And a paragraph break.\n\nLet me know if you have any questions."
    },
    {
      "name": "nested_quotes",
      "description": "Email with multiple levels of quoting",
      "body_text": "Here's my response:\n\n> I think this is a good idea.\n>\n>> But what about this concern?\n>>\n>> It seems important.\n>\n> I addressed that in my previous email.\n\nDoes this clarify things?"
    },
    {
      "name": "code_block_indented",
      "description": "Email with indented code block",
      "body_text": "Here's the fix:\n\n    SELECT * FROM users\n    WHERE id = 1;\n\n    UPDATE users\n    SET name = 'John'\n    WHERE id = 1;\n\nThis should work now."
    },
    {
      "name": "mixed_content",
      "description": "Email with mixed content: code, quotes, and links",
      "body_text": "Thanks for reporting this issue.\n\n> The query is failing with this error:\n> ERROR: division by zero\n\nI think the problem is in this section:\n\n    def calculate(x, y):\n        return x / y\n\nYou can find more info at:\nhttps://docs.python.org/3/library/exceptions.html\n\nLet me know if this helps!"
    },
    {
      "name": "url_in_angle_brackets",
      "description": "Email with URLs wrapped in angle brackets",
      "body_text": "Please review the following:\n\n<https://github.com/postgres/postgres/pull/123>\n<https://www.example.com/docs>\n\nThank you!"
    },
    {
      "name": "tab_indented_code",
      "description": "Email with tab-indented code",
      "body_text": "Here's the implementation:\n\n\tfunction test() {\n\t\tconsole.log('hello');\n\t\treturn true;\n\t}\n\nThis uses tab indentation."
    },
    {
      "name": "four_space_indented_code",
      "description": "Email with 4-space indented code",
      "body_text": "Example code:\n\n    if (condition) {\n        doSomething();\n    }\n\nShould be formatted as code."
    },
    {
      "name": "two_space_indented_code",
      "description": "Email with 2-space indented code",
      "body_text": "JavaScript example:\n\n  function add(a, b) {\n    return a + b;\n  }\n\nNote the 2-space indent."
    },
    {
      "name": "code_block_with_blank_lines",
      "description": "Code block with internal blank lines",
      "body_text": "Here's the function:\n\n    def process():\n        step_one()\n\n        step_two()\n\n        return result\n\nThe blank lines should be preserved."
    },
    {
      "name": "multiple_paragraphs",
      "description": "Email with multiple paragraphs separated by blank lines",
      "body_text": "This is the first paragraph.\n\nThis is the second paragraph.\n\nAnd here's a third paragraph with more content.\nThis line continues the third paragraph."
    },
    {
      "name": "url_without_protocol",
      "description": "Email with various URL formats",
      "body_text": "Check these links:\nhttps://www.example.com/path\nhttp://old-site.com\n\nAlso mentioned: <https://github.com/repo>"
    },
    {
      "name": "empty_body",
      "description": "Email with null/empty body",
      "body_text": null
    },
    {
      "name": "only_whitespace",
      "description": "Email with only whitespace",
      "body_text": "   \n\n  \n\n"
    },
    {
      "name": "sql_in_email",
      "description": "Email containing SQL code",
      "body_text": "The query that's causing issues:\n\n    SELECT u.id, u.name, COUNT(o.id) as order_count\n    FROM users u\n    LEFT JOIN orders o ON u.id = o.user_id\n    WHERE u.created_at > '2024-01-01'\n    GROUP BY u.id, u.name\n    HAVING COUNT(o.id) > 5;\n\nLet me know if you need help optimizing it."
    },
    {
      "name": "patch_diff_format",
      "description": "Email containing a patch/diff",
      "body_text": "Here's the proposed change:\n\n    --- a/src/backend/parser/parse_coerce.c\n    +++ b/src/backend/parser/parse_coerce.c\n    @@ -123,6 +123,9 @@\n     case UNKNOWNOID:\n    +    if (targetTypeId == UNKNOWNOID)\n    +        return node;\n    +\n         /* existing code */\n\nWhat do you think?"
    },
    {
      "name": "decoupling_our_alignment_assumptions_about",
      "id": "<1127261.1769649624@sss.pgh.pa.us>",
      "description": "Decoupling our alignment assumptions about int64 and double",
      "body_text": "Over in the long-running thread about resurrecting AIX support,\none salient concern is that AIX has alignof(int64) = 8 but\nalignof(double) = 4.  This breaks all our code that supposes\nthat ALIGNOF_DOUBLE is the platform's maximum alignment spec.\nWe had coped with this via various unspeakable klugery back\nwhen AIX was considered supported, but nobody wants to put\nback those restrictions if we re-support AIX.  (See my gripe\nat [1], but I believe Heikki and Andres complained of this\nin more detail long ago.)\n\nHere is a modest proposal for fixing that in a clean way.\nLet's break TYPALIGN_DOUBLE into three values, TYPALIGN_DOUBLE\nfor float8 only, TYPALIGN_INT64 for 64-bit integral types\nincluding pointers, and TYPALIGN_MAX to represent MAXALIGN\nalignment regardless of which of the first two determine it.\nWe need TYPALIGN_MAX because that's the value composite\ntypes should use, so that their alignment doesn't change\nif somebody adds or deletes a column of a relevant type.\nGiven that design, the patch is pretty straightforward,\nand smaller than I feared it might be.  (Though I might\nhave missed a spot or two.)\n\nI think this is good cleanup and deserves consideration\nwhether we accept the AIX patch soon or not.\n\nA loose end that deserves mention is that I noticed we\nare very inconsistent about the length/alignment\nattributed to polymorphic types:\n\nselect typname, typlen, typalign from pg_type where typname like 'any%';\n         typname         | typlen | typalign \n-------------------------+--------+----------\n any                     |      4 | i\n anyarray                |     -1 | m\n anycompatible           |      4 | i\n anycompatiblearray      |     -1 | m\n anycompatiblemultirange |     -1 | m\n anycompatiblenonarray   |      4 | i\n anycompatiblerange      |     -1 | m\n anyelement              |      4 | i\n anyenum                 |      4 | i\n anymultirange           |     -1 | m\n anynonarray             |      4 | i\n anyrange                |     -1 | m\n(12 rows)\n\n(Previous to this patch, the 'm' entries were 'd'.)\n\nIn one sense this doesn't really matter, since no actual\nvalue should have any of these types attributed to it;\nbut it annoys me that they're not all alike.  I'm tempted to\nmake them all 4/'i' which seems to be the older convention.\n\nA more aggressive answer would be to change these to some\nactually-illegal values, in hopes of catching anyplace where\nwe did try to rely on the values.  But that seems like\nmaterial for a different patch.\n\n\t\t\tregards, tom lane\n\n[1] https://www.postgresql.org/message-id/581905.1769550155%40sss.pgh.pa.us\n\n"
    },
    {
      "name": "add_pgstatrecovery_system_view",
      "id": "<CABPTF7W+Nody-+P9y4PNk37-QWuLpfUrEonHuEhrX+Vx9Kq+Kw@mail.gmail.com>",
      "description": "Add pg_stat_recovery system view",
      "body_text": "Hi Hackers,\n\nThis patch series introduces pg_stat_recovery, a new view that exposes\nthe startup process’s internal recovery state at the SQL level. It\nfollows the pattern of pg_stat_wal_receiver, but focuses on WAL replay\nand recovery rather than WAL reception.\n\nThe view provides visibility into replay progress, recovery timing,\nand operational status—information that was previously scattered\nacross separate function calls or not exposed at all.\n\nAs Michael suggested [1][2], this view is intentionally independent of\nwalreceiver state, since the startup process can consume WAL from\nmultiple sources (archive, pg_wal, or streaming), not just streaming\nreplication.\n\nThe patch series:\n0001: Refactor: move XLogRecoveryCtlData struct to xlogrecovery.h\nMove the XLogRecoveryCtlData struct definition from xlogrecovery.c to\nxlogrecovery.h,\n\n0002: Add pg_stat_recovery system view\nIntroduces the core view with columns\n\n0003: Refactor: move XLogSource enum to xlogrecovery.h\nPreparatory refactoring to make XLogSource visible externally.\n\n0004: Add wal_source column to pg_stat_recovery\nAdds wal_source column showing where WAL was last read from:\n'archive', 'pg_wal', or 'stream'.\n\nExample usage on a standby:\n\nSELECT promote_triggered, pause_state, wal_source,\npg_size_pretty(pg_wal_lsn_diff(replay_end_lsn, last_replayed_end_lsn))\nFROM pg_stat_recovery;\n\npromote_triggered | pause_state | wal_source | pg_size_pretty\n-------------------+-------------+------------+----------------\nf | not paused | stream | 0 bytes\n\nFeedbacks welcome.\n\n[1] https://www.postgresql.org/message-id/aW13GJn_RfTJIFCa@paquier.xyz\n[2] https://www.postgresql.org/message-id/aW68b79-9U3WPZiz@paquier.xyz\n\n-- \nBest,\nXuneng\n"
    },
    {
      "name": "postgres_table_in_quote",
      "description": "PostgreSQL table inside a quoted section",
      "body_text": "Thanks for the report!\n\n> I ran this query:\n>\n>     SELECT id, name, status\n>     FROM users\n>     WHERE active = true;\n>\n> And got this result:\n>\n>  id | name  | status\n> ----+-------+--------\n>   1 | Alice | active\n>   2 | Bob   | active\n>\n> Is this expected?\n\nYes, that's the correct output."
    },
    {
      "name": "postgres_table_no_separator",
      "description": "PostgreSQL-style output without separator line",
      "body_text": "Quick results:\n\n column_name | data_type | is_nullable\n-------------+-----------+-------------\n id          | integer   | NO\n name        | text      | YES\n created_at  | timestamp | NO\n\nLooks good to me."
    },
    {
      "name": "fenced_code_block",
      "description": "Email with markdown fenced code block",
      "body_text": "Here's the implementation:\n\n```javascript\nfunction calculateTotal(items) {\n  return items.reduce((sum, item) => sum + item.price, 0);\n}\n```\n\nLet me know if this works!"
    },
    {
      "name": "fenced_code_block_no_language",
      "description": "Fenced code block without language specifier",
      "body_text": "Quick fix:\n\n```\nSELECT * FROM users\nWHERE active = true;\n```\n\nThis should resolve the issue."
    },
    {
      "name": "multiple_fenced_code_blocks",
      "description": "Email with multiple fenced code blocks",
      "body_text": "First, update the schema:\n\n```sql\nCREATE TABLE products (\n  id SERIAL PRIMARY KEY,\n  name TEXT NOT NULL\n);\n```\n\nThen use this query:\n\n```sql\nSELECT * FROM products\nORDER BY name;\n```\n\nDone!"
    },
    {
      "name": "mixed_fenced_and_indented",
      "description": "Email with both fenced and indented code blocks",
      "body_text": "You can use either format:\n\n```python\ndef hello():\n    print('fenced')\n```\n\nOr the indented style:\n\n    def hello():\n        print('indented')\n\nBoth should work."
    },
    {
      "name": "fenced_with_markdown_links",
      "description": "Fenced code block in email with markdown links",
      "body_text": "Check the docs at https://example.com/docs\n\nHere's the code:\n\n```bash\npig repo set\npig install pg18\npig install pg_duckdb --v 18\n```\n\nSee also [Documentation](https://pgext.cloud/pig/)"
    },
    {
      "name": "markdown_link_simple",
      "description": "Email with simple markdown link",
      "body_text": "Check out the [PostgreSQL documentation](https://www.postgresql.org/docs/) for more information."
    },
    {
      "name": "markdown_link_multiple",
      "description": "Email with multiple markdown links",
      "body_text": "See the [API docs](https://api.example.com) and [user guide](https://guide.example.com) for details."
    },
    {
      "name": "markdown_mixed_with_bare_urls",
      "description": "Email with both markdown links and bare URLs",
      "body_text": "Visit [our website](https://example.com) or https://blog.example.com for updates.\n\nYou can also check <https://docs.example.com>."
    },
    {
      "name": "markdown_link_with_special_chars",
      "description": "Markdown link with special characters in URL",
      "body_text": "See the [commit message](https://github.com/org/repo/commit/abc123?param=value&other=test) for details."
    },
    {
      "name": "markdown_link_in_quoted_text",
      "description": "Markdown link inside quoted text",
      "body_text": "I agree with your point.\n\n> Please review the [patch](https://lists.postgresql.org/message-id/123)\n> before merging.\n\nLooks good to me!"
    },
    {
      "name": "bold_double_asterisk",
      "description": "Email with bold text using **",
      "body_text": "This is **PostgreSQL 13-18** with support for extensions."
    },
    {
      "name": "bold_double_underscore",
      "description": "Email with bold text using __",
      "body_text": "The __important note__ is at the bottom."
    },
    {
      "name": "italic_single_asterisk",
      "description": "Email with italic text using *",
      "body_text": "Please *review carefully* before merging."
    },
    {
      "name": "italic_single_underscore",
      "description": "Email with italic text using _",
      "body_text": "The _emphasis_ is on testing."
    },
    {
      "name": "bold_and_italic",
      "description": "Email with both bold and italic",
      "body_text": "This is **bold text** and this is *italic text* in the same sentence."
    },
    {
      "name": "multiple_bold",
      "description": "Email with multiple bold sections",
      "body_text": "**First** section and **second** section are both important."
    },
    {
      "name": "bold_italic_links",
      "description": "Email with bold, italic, and links mixed",
      "body_text": "Check **PostgreSQL 13-18** at [our website](https://example.com) for *more details*."
    },
    {
      "name": "bold_in_quoted_text",
      "description": "Bold text inside quoted text",
      "body_text": "I agree.\n\n> The **critical issue** needs to be addressed.\n> Please review.\n\nThanks!"
    },
    {
      "name": "nested_formatting_protection",
      "description": "Prevent nested formatting issues",
      "body_text": "This has **bold with a link [inside](https://example.com)** text."
    },
    {
      "name": "sql_select_statement",
      "description": "Email with SELECT statement",
      "body_text": "Here's the query:\n\nSELECT id, name, email\nFROM users\nWHERE active = true;\n\nLet me know if this works."
    },
    {
      "name": "sql_insert_statement",
      "description": "Email with INSERT statement",
      "body_text": "Use this to add data:\n\nINSERT INTO products (name, price)\nVALUES ('Widget', 19.99);\n\nShould work fine."
    },
    {
      "name": "sql_update_statement",
      "description": "Email with UPDATE statement",
      "body_text": "Try this update:\n\nUPDATE users\nSET status = 'active'\nWHERE id = 123;\n\nDone."
    },
    {
      "name": "sql_delete_statement",
      "description": "Email with DELETE statement",
      "body_text": "Remove old records:\n\nDELETE FROM logs\nWHERE created_at < '2024-01-01';\n\nBe careful!"
    },
    {
      "name": "sql_create_table",
      "description": "Email with CREATE TABLE statement",
      "body_text": "Here's the schema:\n\nCREATE TABLE orders (\n  id SERIAL PRIMARY KEY,\n  user_id INTEGER NOT NULL,\n  total DECIMAL(10, 2)\n);\n\nLooks good."
    },
    {
      "name": "sql_with_cte",
      "description": "Email with CTE (WITH clause)",
      "body_text": "Complex query example:\n\nWITH active_users AS (\n  SELECT * FROM users WHERE active = true\n)\nSELECT * FROM active_users;\n\nThis uses a CTE."
    },
    {
      "name": "sql_mixed_case_ignored",
      "description": "Mixed case SQL should not be detected",
      "body_text": "This sentence has select in it but not at the start.\n\nAlso, Select with capital S should not match.\n\nOnly uppercase keywords trigger detection."
    },
    {
      "name": "sql_with_text",
      "description": "SQL statement with surrounding text",
      "body_text": "The issue can be fixed with:\n\nSELECT version();\n\nThis will show the PostgreSQL version."
    },
    {
      "name": "sql_multiple_statements",
      "description": "Multiple SQL statements",
      "body_text": "Run these queries:\n\nSELECT COUNT(*) FROM users;\n\nSELECT COUNT(*) FROM orders;\n\nBoth should return counts."
    },
    {
      "name": "postgres_table_with_diff",
      "description": "PostgreSQL table with diff-style +/- rows showing before/after states",
      "body_text": "After running the index merge, here are the statistics:\n\nWHERE indexrelname = 'btree_merge_test_idx';\n\n idx_scan | idx_tup_read | idx_tup_fetch\n----------+--------------+---------------\n-       5 |           10 |            10\n+       5 |          224 |           224\n(1 row)\n\nThe + row shows the new values after merge."
    },
    {
      "name": "postgres_table_multiple_diffs",
      "description": "PostgreSQL table with multiple diff rows",
      "body_text": "Comparison of query plans:\n\n operation | cost_before | cost_after | rows\n-----------+-------------+------------+------\n- Seq Scan |      100.00 |            |  1000\n+ Index Scan |         |      25.50 |  1000\n- Hash Join |      500.00 |            |  5000\n+ Merge Join |         |     150.00 |  5000\n(4 rows)\n\nClear improvement in costs."
    },
    {
      "name": "sql_nested_escaped_quotes",
      "id": "<CADkLM=fZci8mBEoKX9Gk-+0jXrVmQBuTErP-0JYgE1iUL+EX2A@mail.gmail.com>",
      "description": "Re: Add expressions to pg_restore_extended_stats()",
      "body_text": "On Fri, Jan 30, 2026 at 12:55 AM Michael Paquier <michael@paquier.xyz>\nwrote:\n\n> On Fri, Jan 30, 2026 at 12:08:49AM -0500, Corey Huinker wrote:\n> > 3. Keeping the 2-D text array in #1, but each \"row\" is a list of\n> > kwargs-like pairs like the arguments used in pg_restore_attribute_stats\n> > (i.e. ARRAY['null_frac','0.5','avg_width','1.0','most_common_values',...]\n> >\n> > 4. JSON. The outer structure would be an array of objects, each object\n> > would be a key-value.\n>\n> I'd still favor 4 on the ground that it's easier to edit and read,\n> which would more in line with the MCV, dependencies, ndistinct and\n> att/rel statistics.  The format proposed in the attached patch is hard\n> to work with, anyway.  Now, I do take your point about composite\n> record values casted into a single text value could be confusing\n> (double-quote issues, I guess?), so perhaps a text[] as in 3 would be\n> more adapted for readability.\n\n\nHmm, maybe it isn't so bad:\n\nSELECT '{\"{\\\"{1,1}\\\",\\\"{2,1}\\\",\\\"{3,-1}\\\",\\\"{NULL,0}\\\"}\"}'::text[];\n                       text\n---------------------------------------------------\n {\"{\\\"{1,1}\\\",\\\"{2,1}\\\",\\\"{3,-1}\\\",\\\"{NULL,0}\\\"}\"}\n(1 row)\n\nSELECT\narray_to_json('{\"{\\\"{1,1}\\\",\\\"{2,1}\\\",\\\"{3,-1}\\\",\\\"{NULL,0}\\\"}\"}'::text[]);\n                   array_to_json\n---------------------------------------------------\n [\"{\\\"{1,1}\\\",\\\"{2,1}\\\",\\\"{3,-1}\\\",\\\"{NULL,0}\\\"}\"]\n(1 row)\n\nMind you, this is an ANYARRAY first casted to text, if we cast the\npg_stats_ext_exprs.most_common_values directly to JSON then it'll drill\ndown into the innards of the composite values because it can see the local\ndatatypes, and that breaks our ability to use regular input functions. I\nlearned that the hard way when using JSON for serializing attribute stats\nstuff when this effort first began.\n\nBefore seeing that, I wanted to try option 3 first, as it brings clarity\nwith no real increase in tooling other than looking for repeated keywords,\nbut if you're hyped for json then I'll try that first.\n\n\n> We could also force some checks based\n> the order of the arguments in the input array, so as duplicates are\n> not an issue, I guess?\n>\n\nIf we're doing a kwargs-thing then I may as well just track which keywords\nwere already used. We already bail out on the whole expressions array at\nthe first sign of inconsistency, so it's not like we have to decide which\nof the duplicates to keep.\n\nStructurally, I feel that import_expressions() is overcomplicated, and\n> with the correct structure tracking the state of each field, I would\n> try to reduce a bit the duplication that the patch presents, aiming at\n> less callers of statatt_build_stavalues() and statatt_set_slot(),\n> perhaps.\n>\n\nI don't think we can get around those. It's a limitation of how the\nsta(kindN/opN/collN/numbersN/valuesN) system in pg_statistic works. We want\nto fill in each stakind as we find it, and we don't know how many of them\nwe've already filled out. An array of records would have been better, but\nwe've got 5 parallel arrays of scalars and we have to live with it."
    }
  ]
}
